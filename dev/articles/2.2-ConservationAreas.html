<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Module 2 - Conservation Areas • naturecounts</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Module 2 - Conservation Areas">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">naturecounts</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.4.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/BirdsCanada/naturecounts/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Module 2 - Conservation Areas</h1>
                        <h4 data-toc-skip class="author">Dimitrios
Markou</h4>
            
            <h4 data-toc-skip class="date">2024-11-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/BirdsCanada/naturecounts/blob/docs-update/vignettes/articles/2.2-ConservationAreas.Rmd" class="external-link"><code>vignettes/articles/2.2-ConservationAreas.Rmd</code></a></small>
      <div class="d-none name"><code>2.2-ConservationAreas.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="module-2-conservation-areas-kbas-and-priority-places">Module 2: Conservation Areas: KBA’s and Priority Places<a class="anchor" aria-label="anchor" href="#module-2-conservation-areas-kbas-and-priority-places"></a>
</h2>
<div class="section level6">
<h6 id="author-dimitrios-markou">Author: Dimitrios Markou<a class="anchor" aria-label="anchor" href="#author-dimitrios-markou"></a>
</h6>
<p>The <a href="https://github.com/BirdsCanada/NatureCounts_SpatialData_Tutorial" class="external-link">NatureCounts_SpatialData_Tutorial</a>
modules aim to help users integrate NatureCounts data with spatial and
environmental layers in R and meet their conservation and research
goals. In <a href="01-SpatialDataExploration.Rmd"><strong>Module 1:
Spatial Data Exploration</strong></a>, you distinguished between spatial
data types (vector and raster) and explored NatureCounts data using a
spatio-temporal map.</p>
<p>Mapping the spatial distribution of avian and environmental data is
critical to our understanding of ecological processes. Conservation
actions are most effective when focused on areas of ecological
importance. These areas typically host high levels of biodiversity,
concentrations of rare species, or species at risk. In this way,
analyzing NatureCounts data within specific boundaries might be relevant
to your work.</p>
</div>
</div>
<div class="section level2">
<h2 id="learning-objectives">2.0 Learning Objectives<a class="anchor" aria-label="anchor" href="#learning-objectives"></a>
</h2>
<p>By the end of <strong>Module 2 - Conservation Areas</strong>, users
will know how to:</p>
<ul>
<li>Apply basic geoprocessing functions to spatial objects.</li>
</ul>
<!-- --><ul>
<li>Read, process, and visualize spatial vector data in R within areas
of significant conservation potential: <a href="https://kbacanada.org/about/" class="external-link">Key Biodiversity Areas (KBAs)</a>
and <a href="https://environmental-maps.canada.ca/CWS_Storylines/index-ca-en.html#/en/priority_places-lieux_prioritaires" class="external-link">Priority
Places for Species at Risk</a>.</li>
</ul>
<p>The data used in this tutorial are downloaded from NatureCounts using
R, the <a href="https://kbacanada.org/explore/map-viewer/" class="external-link">KBA Canada
Map Viewer</a>, and the <a href="https://open.canada.ca/data/en/dataset/91219d24-e877-4c8a-8bd2-b2b662e573e0" class="external-link">Priority
Places - Open Government Portal</a>.</p>
<p>This R tutorial requires the following <strong>packages</strong>:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/BirdsCanada/naturecounts" class="external-link">naturecounts</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/" class="external-link">terra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://paleolimbot.github.io/ggspatial/" class="external-link">ggspatial</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/mapview" class="external-link">mapview</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/" class="external-link">leaflet</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/trafficonese/leaflet.extras" class="external-link">leaflet.extras</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet.providers/" class="external-link">leaflet.providers</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="key-biodiversity-areas">2.1 Key Biodiversity Areas<a class="anchor" aria-label="anchor" href="#key-biodiversity-areas"></a>
</h2>
<div class="section level5">
<h5 id="example-2a---you-want-to-assess-the-spatial-distribution-of-wood-ducks-ontario-breeding-bird-atlas-data-across-the-kbas-found-within-the-province-">
<em>Example 2a</em> - You want to assess the spatial distribution of
Wood Ducks (Ontario Breeding Bird Atlas data) across the KBAs found
within the province.<a class="anchor" aria-label="anchor" href="#example-2a---you-want-to-assess-the-spatial-distribution-of-wood-ducks-ontario-breeding-bird-atlas-data-across-the-kbas-found-within-the-province-"></a>
</h5>
<p>To view your working directory.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>It helps if you assign these files a meaningful name! We can read in
our KBA polygons using the <code>sf</code> package once it is in your
working directory.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ontario_kba</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="st">"C:/Users/dimit/Birds Canada/Data/kba/provontario_kba/ontario_kba.shp"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Reading layer `ontario_kba' from data source `C:\Users\dimit\Birds Canada\Data\kba\provontario_kba\ontario_kba.shp' using driver `ESRI Shapefile'</span></span>
<span><span class="co">## Simple feature collection with 198 features and 8 fields</span></span>
<span><span class="co">## Geometry type: POLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -94.52593 ymin: 42.22596 xmax: -75.79267 ymax: 51.95705</span></span>
<span><span class="co">## Geodetic CRS:  WGS 84</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ontario_kba</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="st">"ontario_kba.shp"</span><span class="op">)</span></span></code></pre></div>
<p><code>sf</code> objects are stored in R as a spatial dataframe which
contains the attribute table of the vector along with the geometry type.
When we examine the dataframe, it looks like there are many duplicate
entries including duplicate geometries (vertices). To clean this up, we
can apply the <code><a href="https://r-spatial.github.io/sf/reference/valid.html" class="external-link">st_make_valid()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct()</a></code>
functions to our spatial dataframe:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ontario_kba</span> <span class="op">&lt;-</span> <span class="va">ontario_kba</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/valid.html" class="external-link">st_make_valid</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Our spatial data is also accompanied by a CSV file that contains
additional useful attributes (landcover, species, etc) concerning our
KBAs. Let’s read in the accompanying CSV file for our KBA layer.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kba_attributes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"ontario_kba.csv"</span><span class="op">)</span></span></code></pre></div>
<p>Great! We can now join these dataframes using the handy
<code>tidyverse</code> package. However, we’ll want to select for
specific columns first to avoid redundancies before performing our
join:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kba_attributes</span> <span class="op">&lt;-</span> <span class="va">kba_attributes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"SiteCode"</span>,</span>
<span>         <span class="st">"DateAssessed"</span>,</span>
<span>         <span class="st">"PercentProtected"</span>,</span>
<span>         <span class="st">"BoundaryGeneralized"</span>,</span>
<span>         <span class="st">"Level"</span>,</span>
<span>         <span class="st">"CriteriaMet"</span>,</span>
<span>         <span class="st">"ConservationActions"</span>,</span>
<span>         <span class="st">"Landcover"</span>,</span>
<span>         <span class="st">"Province"</span>,</span>
<span>         <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in h(simpleError(msg, call)): error in evaluating the argument 'x' in selecting a method for function 'select': object 'kba_attributes' not found</span></span></code></pre>
<p>Both dataframes now contain unique columns, after our selection. We
apply the <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join()</a></code> function to hold all attributes
within one dataframe.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ontario_kba</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">ontario_kba</span>, <span class="va">kba_attributes</span>, by <span class="op">=</span> <span class="st">"SiteCode"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error in eval(expr, envir, enclos): object 'kba_attributes' not found</span></span></code></pre>
<p>To visualize the <strong>ontario_kba</strong> data we can use
<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Select the basemap</span></span>
<span>  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_map_tile.html" class="external-link">annotation_map_tile</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"cartolight"</span>, zoom <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add the polygon data</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ontario_kba</span>, fill <span class="op">=</span> <span class="st">"red"</span>, color <span class="op">=</span> <span class="st">"black"</span>, </span>
<span>          size <span class="op">=</span> <span class="fl">0.5</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add the map components</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Ontario KBAs"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottomright"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Key Biodiversity Areas (KBAs) of Ontario"</span> ,</span>
<span>       x <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Latitude"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Zoom: 4</span></span></code></pre>
<div class="float">
<img src="figure/ontario_kbas-1.png" alt="plot of chunk ontario_kbas"><div class="figcaption">plot of chunk ontario_kbas</div>
</div>
<div class="float">
<img src="figures%2Fspatdatatutorial_ontario_kbas-1.png" alt="plot of chunk ontario_kbas"><div class="figcaption">plot of chunk ontario_kbas</div>
</div>
<p>We can also visualize the <strong>ontario_kba</strong> data with an
interactive map, using the <code>leaflet</code> package.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rstudio.github.io/leaflet/reference/leaflet.html" class="external-link">leaflet</a></span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/map-layers.html" class="external-link">addTiles</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/map-layers.html" class="external-link">addPolygons</a></span><span class="op">(</span>data<span class="op">=</span><span class="va">ontario_kba</span>,color <span class="op">=</span> <span class="st">"black"</span>, weight <span class="op">=</span> <span class="fl">2</span>, smoothFactor <span class="op">=</span> <span class="fl">1</span>,opacity <span class="op">=</span> <span class="fl">1.0</span>, fillOpacity <span class="op">=</span> <span class="fl">0.5</span>, fillColor <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://trafficonese.github.io/leaflet.extras/reference/fullscreen.html" class="external-link">addFullscreenControl</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/addLegend.html" class="external-link">addLegend</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"red"</span><span class="op">)</span>,labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ontario KBAs"</span><span class="op">)</span>,position <span class="op">=</span> <span class="st">"bottomright"</span><span class="op">)</span></span></code></pre></div>
<p>Similarly, the package <code>mapview</code> (based on leaflet) can
also be used to make interactive plots. We can represent specific
attributes like so:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mapview</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mapview/man/mapView.html" class="external-link">mapview</a></span><span class="op">(</span><span class="va">ontario_kba</span>, zcol <span class="op">=</span> <span class="st">"PercentProtected"</span><span class="op">)</span></span></code></pre></div>
<p>In this example, were interested in all the KBA polygons of Ontario.
However, if you were working with a larger data set, it is possible to
filter your dataframe to retrieve only specific polygons that meet
certain criteria relevant to your research. To do so, we can apply
filters based on a variable condition. For example, say we only wanted
KBA’s greater than 100km^2 in size:</p>
<blockquote>
<p>To execute this code chunk, remove the #</p>
</blockquote>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># kba_name &lt;- ontario_kba %&gt;% </span></span>
<span>  <span class="co"># dplyr::filter(Area &gt; 100) </span></span></code></pre></div>
<p>Let’s search NatureCounts for the Ontario Breeding Bird Atlas point
count dataset using <code><a href="../reference/meta.html">meta_collections()</a></code> and the Wood Duck
species ID using <code><a href="../reference/search_species.html">search_species()</a></code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">collections</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/meta.html">meta_collections</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="fu"><a href="../reference/meta.html">meta_collections</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/search_species.html">search_species</a></span><span class="op">(</span><span class="st">"wood duck"</span><span class="op">)</span></span></code></pre></div>
<p>Then let’s filter and download the NatureCounts data.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">atlas_on</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nc_data_dl.html">nc_data_dl</a></span><span class="op">(</span>collections <span class="op">=</span> <span class="st">"ONATLAS3PC"</span>, species <span class="op">=</span> <span class="fl">360</span>, username <span class="op">=</span> <span class="st">"testuser"</span>, info <span class="op">=</span> <span class="st">"spatial_data_tutorial"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using filters: collections (ONATLAS3PC); species (360); fields_set (BMDE2.00-min)</span></span></code></pre>
<pre><code><span><span class="co">## Collecting available records...</span></span></code></pre>
<pre><code><span><span class="co">## Error: You do not have permission to access these collections (ONATLAS3PC)</span></span></code></pre>
<p>We can then convert our NatureCounts data into a spatial object. To
do so, we deploy the <code>st_as_sf</code> function and specify the
coordinate reference system (CRS).</p>
<p>The CRS of our KBA sf object can be returned with
<code><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs()</a></code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">ontario_kba</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Coordinate Reference System:</span></span>
<span><span class="co">##   User input: WGS 84 </span></span>
<span><span class="co">##   wkt:</span></span>
<span><span class="co">## GEOGCRS["WGS 84",</span></span>
<span><span class="co">##     DATUM["World Geodetic System 1984",</span></span>
<span><span class="co">##         ELLIPSOID["WGS 84",6378137,298.257223563,</span></span>
<span><span class="co">##             LENGTHUNIT["metre",1]]],</span></span>
<span><span class="co">##     PRIMEM["Greenwich",0,</span></span>
<span><span class="co">##         ANGLEUNIT["degree",0.0174532925199433]],</span></span>
<span><span class="co">##     CS[ellipsoidal,2],</span></span>
<span><span class="co">##         AXIS["latitude",north,</span></span>
<span><span class="co">##             ORDER[1],</span></span>
<span><span class="co">##             ANGLEUNIT["degree",0.0174532925199433]],</span></span>
<span><span class="co">##         AXIS["longitude",east,</span></span>
<span><span class="co">##             ORDER[2],</span></span>
<span><span class="co">##             ANGLEUNIT["degree",0.0174532925199433]],</span></span>
<span><span class="co">##     ID["EPSG",4326]]</span></span></code></pre>
<p>Our KBA sf object is stored with World Geodetic System 1984 (WGS 84)
coordinates, EPSG = 4326. Now we can convert our
<strong>atlas_on</strong> dataframe to an sf object using the same
CRS.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">atlas_on_sf</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">atlas_on</span>,</span>
<span>                        coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span></code></pre></div>
<p>Now let’s ensure that the conversion was successful. You’ll notice a
new geometry column where each observation is a point.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">atlas_on_sf</span><span class="op">)</span> <span class="co"># view the sf object</span></span></code></pre></div>
<p>The <code><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform()</a></code> function can be applied to project
our spatial object using a different CRS like NAD83 / UTM zone 16N (EPSG
= 26916).</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ontario_kba</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">ontario_kba</span>, crs <span class="op">=</span> <span class="fl">26916</span><span class="op">)</span> </span></code></pre></div>
<p>It can also be used to ensure that the CRS of our spatial objects
match.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">atlas_on_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">atlas_on_sf</span>, crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">ontario_kba</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>To identify Wood Ducks observed across Ontario KBA’s, we can apply
the <code><a href="https://r-spatial.github.io/sf/reference/geos_binary_ops.html" class="external-link">st_intersection()</a></code> function.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wood_ducks_kba</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_ops.html" class="external-link">st_intersection</a></span><span class="op">(</span><span class="va">ontario_kba</span>, <span class="va">atlas_on_sf</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: attribute variables are assumed to be spatially constant throughout all geometries</span></span></code></pre>
<p>You will get a <code>warning</code> message, which you can safely
ignore.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># If need be, transform your spatial data back to EPSG:4326 to visualize with leaflet</span></span>
<span><span class="va">ontario_kba</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">ontario_kba</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span><span class="va">wood_ducks_kba</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">wood_ducks_kba</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span></code></pre></div>
<p>Using <code>ggplot</code>, we can visualize the polygon data and
point data.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Select a basemap</span></span>
<span>  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_map_tile.html" class="external-link">annotation_map_tile</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"osm"</span>, zoom <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Plot the filtered KBA polygon (ON001)</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ontario_kba_LP</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Ontario KBA"</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.5</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Plot the Wood Duck observations that are within the KBA</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">wood_ducks_kba_LP</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Wood Duck Observations"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Custom fill and color for the legend</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ontario KBA"</span> <span class="op">=</span> <span class="st">"violet"</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Legend"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Wood Duck Observations"</span> <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Legend"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Automatically zoom to the extent of the ON001 polygon</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Map components</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottomright"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Key Biodiversity Area (KBA) - Long Point Peninsula and Marshes"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Latitude"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Zoom: 9</span></span></code></pre>
<div class="float">
<img src="figure/longpoint_kba-1.png" alt="plot of chunk longpoint_kba"><div class="figcaption">plot of chunk longpoint_kba</div>
</div>
<div class="float">
<img src="figures%2Fspatdatatutorial_longpoint_kba-1.png" alt="plot of chunk longpoint_kba"><div class="figcaption">plot of chunk longpoint_kba</div>
</div>
<p>You can also apply <code>leaflet</code> to create an interactive map,
using the <code><a href="https://rstudio.github.io/leaflet/reference/map-layers.html" class="external-link">addPolygons()</a></code> <code><a href="https://rstudio.github.io/leaflet/reference/map-layers.html" class="external-link">addCircleMarkers()</a></code>
arguments.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rstudio.github.io/leaflet/reference/leaflet.html" class="external-link">leaflet</a></span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/map-layers.html" class="external-link">addTiles</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/map-layers.html" class="external-link">addPolygons</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ontario_kba</span>, color <span class="op">=</span> <span class="st">"black"</span>, weight <span class="op">=</span> <span class="fl">2</span>, smoothFactor <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  opacity <span class="op">=</span> <span class="fl">1.0</span>, fillOpacity <span class="op">=</span> <span class="fl">0.5</span>, fillColor <span class="op">=</span> <span class="st">"violet"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/map-layers.html" class="external-link">addCircleMarkers</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">wood_ducks_kba</span>, radius <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"orange"</span>, </span>
<span>                   stroke <span class="op">=</span> <span class="cn">FALSE</span>, fillOpacity <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://trafficonese.github.io/leaflet.extras/reference/fullscreen.html" class="external-link">addFullscreenControl</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/addLegend.html" class="external-link">addLegend</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"violet"</span>, <span class="st">"orange"</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ontario KBA"</span>, <span class="st">"Wood Duck Observations"</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">"bottomright"</span><span class="op">)</span></span></code></pre></div>
<p>After geoprocessing our data in R, we can write out any sf objects to
Shapefiles on a disk, where the argument delete_layer = TRUE is used to
overwrite a file.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># st_write(wood_ducks_kba,"wood_ducks_kba.shp", driver = "ESRI Shapefile", delete_layer = TRUE)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="priority-places">2.2 Priority Places<a class="anchor" aria-label="anchor" href="#priority-places"></a>
</h2>
<div class="section level5">
<h5 id="example-2b---you-want-to-assess-the-spatial-distribution-of-wood-ducks-ontario-breeding-bird-atlas-data-across-the-long-point-walsingham-forest-priority-place-">
<em>Example 2b</em> - You want to assess the spatial distribution of
Wood Ducks (Ontario Breeding Bird Atlas data) across the Long Point
Walsingham Forest Priority Place.<a class="anchor" aria-label="anchor" href="#example-2b---you-want-to-assess-the-spatial-distribution-of-wood-ducks-ontario-breeding-bird-atlas-data-across-the-long-point-walsingham-forest-priority-place-"></a>
</h5>
<p>First, lets create a path to our downloaded Priority Place file.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gdb_path</span> <span class="op">&lt;-</span> <span class="st">"C:/Users/dimit/Birds Canada/Data/priority_places/priorityplaces.gdb"</span></span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gdb_path</span> <span class="op">&lt;-</span> <span class="st">"PriorityPlaces.gdb"</span></span></code></pre></div>
<p>Then, let’s inspect the spatial data.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gdb_layers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_layers.html" class="external-link">st_layers</a></span><span class="op">(</span><span class="va">gdb_path</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gdb_layers</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Driver: OpenFileGDB </span></span>
<span><span class="co">## Available layers:</span></span>
<span><span class="co">##               layer_name geometry_type features fields                     crs_name</span></span>
<span><span class="co">## 1 PriorityPlacesBoundary Multi Polygon       11     11 NAD83 / Canada Atlas Lambert</span></span>
<span><span class="co">## 2  PriorityPlacesProject   Multi Point       89     13 NAD83 / Canada Atlas Lambert</span></span></code></pre>
<p>To read in our spatial data object, we apply the <code>st_read</code>
function and specify our desired data layer.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">priori_place_polygons</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span>dsn <span class="op">=</span> <span class="va">gdb_path</span>, layer <span class="op">=</span> <span class="st">"PriorityPlacesBoundary"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Reading layer `PriorityPlacesBoundary' from data source `C:\Users\dimit\Birds Canada\Data\priority_places\priorityplaces.gdb' using driver `OpenFileGDB'</span></span>
<span><span class="co">## Simple feature collection with 11 features and 11 fields</span></span>
<span><span class="co">## Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -2135754 ymin: -586679 xmax: 2450963 ymax: 2554209</span></span>
<span><span class="co">## Projected CRS: NAD83 / Canada Atlas Lambert</span></span></code></pre>
<p>Were interested in the spatial distribution of Wood Ducks across the
Long Point Walsingham Forest Priority Place. We’ll use
<code>dplyr</code> to filter based on a variable condition.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">long_point_polygon</span> <span class="op">&lt;-</span> <span class="va">priori_place_polygons</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Name</span> <span class="op">==</span> <span class="st">"Long Point Walsingham Forest"</span><span class="op">)</span> <span class="co"># filters based on multipolygon name </span></span></code></pre></div>
<p>Then reproject the Wood Duck data to match our Priority Place using
<code>st_transform</code>.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">atlas_on_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">atlas_on_sf</span>, crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">long_point_polygon</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Next, we’ll apply our geoprocessing function to find the Wood Duck
observations that intersect with our chosen Priority Place.</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wood_ducks_longpoint</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_ops.html" class="external-link">st_intersection</a></span><span class="op">(</span><span class="va">long_point_polygon</span>, <span class="va">atlas_on_sf</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: attribute variables are assumed to be spatially constant throughout all geometries</span></span></code></pre>
<p>Finally, we’ll transform our spatial objects one more time before
visualizing them.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">long_point_polygon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">long_point_polygon</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wood_ducks_longpoint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">wood_ducks_longpoint</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span></code></pre></div>
<p>Use <code>ggplot</code> to visualize the polygon and point data.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Select a basemap</span></span>
<span>  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_map_tile.html" class="external-link">annotation_map_tile</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"cartolight"</span>, zoom <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Plot the Long Point polygon</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">long_point_polygon</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Long Point Walsingham Forest"</span><span class="op">)</span>, </span>
<span>          color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.5</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Plot the Wood Duck observations</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">wood_ducks_longpoint</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Wood Duck Observations"</span><span class="op">)</span>, </span>
<span>          size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Custom fill and color for the legend</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Long Point Walsingham Forest"</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Legend"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Wood Duck Observations"</span> <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Legend"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Automatically zoom to the extent of the Long Point polygon</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Map components</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottomright"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Wood Duck Observations within Long Point Walsingham"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Latitude"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Zoom: 9</span></span></code></pre>
<div class="float">
<img src="figure/longpoint_prioriplace-1.png" alt="plot of chunk longpoint_prioriplace"><div class="figcaption">plot of chunk longpoint_prioriplace</div>
</div>
<div class="float">
<img src="figures%2Fspatdatatutorial_longpoint_prioriplace-1.png" alt="plot of chunk longpoint_prioriplace"><div class="figcaption">plot of chunk longpoint_prioriplace</div>
</div>
<p>After geoprocessing our data in R, we can write out any sf objects to
Shapefiles on a disk, where the argument delete_layer = TRUE is used to
overwrite a file.</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># st_write(wood_ducks_longpoint,"wood_ducks_longpoint.shp", driver = "ESRI Shapefile", delete_layer = TRUE)</span></span></code></pre></div>
<p><strong>Congratulations</strong>! You completed <strong>Module 2 -
Spatial Data Manipulation: KBA’s and Priority Places</strong>. Here, you
successfully filtered and visualized NatureCounts data using
spatio-temporal, KBA, and Priority Place maps. In <a href="03-ClimateData.Rmd">Module 3</a>, you can explore more spatial
data visualization while linking climate data to NatureCounts
observations.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Steffi LaZerte, Denis Lepage.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
