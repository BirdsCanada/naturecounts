<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>02-SpatialFiltering • naturecounts</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="02-SpatialFiltering">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">naturecounts</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.4.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/BirdsCanada/naturecounts/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>02-SpatialFiltering</h1>
            
            <h4 data-toc-skip class="date">2024-11-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/BirdsCanada/naturecounts/blob/docs-update/vignettes/articles/2.2-SpatialFiltering.Rmd" class="external-link"><code>vignettes/articles/2.2-SpatialFiltering.Rmd</code></a></small>
      <div class="d-none name"><code>2.2-SpatialFiltering.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="chapter-2-spatial-filtering-kbas-and-priority-places">Chapter 2: Spatial Filtering: KBA’s and Priority Places<a class="anchor" aria-label="anchor" href="#chapter-2-spatial-filtering-kbas-and-priority-places"></a>
</h2>
<div class="section level6">
<h6 id="authors-dimitrios-markou-danielle-ethier">Authors: Dimitrios Markou, Danielle Ethier<a class="anchor" aria-label="anchor" href="#authors-dimitrios-markou-danielle-ethier"></a>
</h6>
<div class="line-block">In <a href="01-SpatialDataExploration.Rmd"><strong>Chapter 1: Spatial Data
Exploration</strong></a>, you distinguished between spatial data types
(vector and raster) and explored NatureCounts data using a
spatio-temporal map. Now you are ready to focus your data exploration to
a specific geographic area. Analyzing NatureCounts data within specific
boundaries is relevant to many research application. Here we use Key
Biodiversity Areas (KBA) and Priority Places as examples of research
areas of interest.</div>
</div>
</div>
<div class="section level2">
<h2 id="learning-objectives">2.0 Learning Objectives<a class="anchor" aria-label="anchor" href="#learning-objectives"></a>
</h2>
<p>By the end of <strong>Chapter 2 - Spatial Filtering</strong>, users
will know how to:</p>
<ul>
<li>Import and map polygon boundary files based on attributes</li>
<li>Reproject NatureCounts data to the coordinate reference system of
your spatial layer</li>
<li>Spatially filter and map NatureCounts data for an area of
interest</li>
<li>Read, process, and visualize spatial vector data in R within areas
of significant conservation potential: <a href="https://kbacanada.org/about/" class="external-link">Key Biodiversity Areas (KBAs)</a>
and <a href="https://environmental-maps.canada.ca/CWS_Storylines/index-ca-en.html#/en/priority_places-lieux_prioritaires" class="external-link">Priority
Places for Species at Risk</a>.</li>
</ul>
<p>The data used in this tutorial are downloaded from NatureCounts, the
<a href="https://kbacanada.org/explore/map-viewer/" class="external-link">KBA Canada Map
Viewer</a>, and the <a href="https://open.canada.ca/data/en/dataset/91219d24-e877-4c8a-8bd2-b2b662e573e0" class="external-link">Priority
Places - Open Government Portal</a>. You will save the downloaded
shapefiles to your working directory.</p>
<p>To view your working directory.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>This R tutorial requires the following <strong>packages</strong>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/BirdsCanada/naturecounts" class="external-link">naturecounts</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/r-spatial/mapview" class="external-link">mapview</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rstudio.github.io/leaflet/" class="external-link">leaflet</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/trafficonese/leaflet.extras" class="external-link">leaflet.extras</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="key-biodiversity-areas">2.1 Key Biodiversity Areas<a class="anchor" aria-label="anchor" href="#key-biodiversity-areas"></a>
</h2>
<div class="section level5">
<h5 id="example-2a---you-are-interested-in-assessing-the-spatial-distribution-of-wood-ducks-ontario-breeding-bird-atlas-data-across-the-kbas-found-within-the-province-of-ontario-">
<em>Example 2a</em> - You are interested in assessing the spatial
distribution of Wood Ducks (Ontario Breeding Bird Atlas data) across the
KBAs found within the province of Ontario.<a class="anchor" aria-label="anchor" href="#example-2a---you-are-interested-in-assessing-the-spatial-distribution-of-wood-ducks-ontario-breeding-bird-atlas-data-across-the-kbas-found-within-the-province-of-ontario-"></a>
</h5>
<p>Navigate the the <a href="https://kbacanada.org/explore/map-viewer/" class="external-link">KBA Canada Map
Viewer</a> and filter the data for Ontario using the left hand
<code>Province/Territory</code> filter. Then select ‘Download’. You will
want to select both <code>csv</code> and <code>shp</code> for this
example.</p>
<p>We can read in our KBA polygons using the <code>sf</code> package
once it is in your working directory. The downloaded files was renamed
for this example so you will need to change the code to match your file
name.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ontario_kba</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="st">"ontario_kba.shp"</span><span class="op">)</span></span></code></pre></div>
<p><code>sf</code> objects are stored in R as a spatial dataframe which
contains the attribute table of the vector along with the geometry type.
When we examine the dataframe, it looks like there are many duplicate
entries including duplicate geometries (vertices). To clean this up, we
can apply the <code><a href="https://r-spatial.github.io/sf/reference/valid.html" class="external-link">st_make_valid()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct()</a></code>
functions to our spatial dataframe:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ontario_kba</span> <span class="op">&lt;-</span> <span class="va">ontario_kba</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/valid.html" class="external-link">st_make_valid</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Our spatial data is also accompanied by a CSV file that contains
additional useful attributes (landcover, species, etc) concerning our
KBAs. Let’s read in the accompanying CSV file for our KBA layer.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kba_attributes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"ontario_kba.csv"</span><span class="op">)</span></span></code></pre></div>
<p>Great! We can now join these dataframes using the handy
<code>tidyverse</code> package. However, we’ll want to select for
specific columns first to avoid redundancies before performing our
join:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">kba_attributes</span> <span class="op">&lt;-</span> <span class="va">kba_attributes</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="st">"SiteCode"</span>,</span>
<span>         <span class="st">"DateAssessed"</span>,</span>
<span>         <span class="st">"PercentProtected"</span>,</span>
<span>         <span class="st">"BoundaryGeneralized"</span>,</span>
<span>         <span class="st">"Level"</span>,</span>
<span>         <span class="st">"CriteriaMet"</span>,</span>
<span>         <span class="st">"ConservationActions"</span>,</span>
<span>         <span class="st">"Landcover"</span>,</span>
<span>         <span class="st">"Province"</span>,</span>
<span>         <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<p>Both dataframes now contain unique columns, after our selection. We
apply the <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join()</a></code> function to hold all attributes
within one dataframe.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ontario_kba</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">ontario_kba</span>, <span class="va">kba_attributes</span>, by <span class="op">=</span> <span class="st">"SiteCode"</span><span class="op">)</span></span></code></pre></div>
<p>To visualize the <strong>ontario_kba</strong> data we can use
<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="co"># Select the basemap</span></span>
<span>  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_map_tile.html" class="external-link">annotation_map_tile</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"cartolight"</span>, zoom <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add the polygon data</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ontario_kba</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Ontario KBAs"</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, </span>
<span>          size <span class="op">=</span> <span class="fl">0.5</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Add the map components</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ontario KBAs"</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Key Biodiversity Areas (KBAs) of Ontario"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Latitude"</span>,</span>
<span>       fill <span class="op">=</span> <span class="st">"Legend"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Zoom: 4</span></span></code></pre>
<pre><code><span><span class="co">## Fetching 2 missing tiles</span></span></code></pre>
<pre><code>

















``` r
leaflet(width = "100%") %&gt;%
  addTiles() %&gt;%
  addPolygons(data=ontario_kba,color = "black", weight = 2, smoothFactor = 1,opacity = 1.0, fillOpacity = 0.5, fillColor = "red") %&gt;% addFullscreenControl() %&gt;%
  addLegend(colors = c("red"),labels = c("Ontario KBAs"),position = "bottomright")</code></pre>
<p>Similarly, the package <code>mapview</code> (based on leaflet) can be
used to make interactive plots. We can represent specific attributes
like so:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">mapview</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/mapview/man/mapView.html" class="external-link">mapview</a></span><span class="op">(</span><span class="va">ontario_kba</span>, zcol <span class="op">=</span> <span class="st">"PercentProtected"</span><span class="op">)</span></span></code></pre></div>
<p>In this example, were interested in all the KBA polygons of Ontario.
However, if you were working with a larger data set, it is possible to
filter your dataframe to retrieve only specific polygons that meet
certain criteria relevant to your research. To do so, we can apply
filters based on a variable condition. For example, say we only wanted
KBA’s greater than 100km^2 in size:</p>
<blockquote>
<p>To execute this code chunk, remove the #</p>
</blockquote>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># kba_name &lt;- ontario_kba %&gt;% </span></span>
<span>  <span class="co"># dplyr::filter(Area &gt; 100) </span></span></code></pre></div>
<p>Let’s search NatureCounts for the Ontario Breeding Bird Atlas point
count dataset using <code><a href="../reference/meta.html">meta_collections()</a></code> and the Wood Duck
species ID using <code><a href="../reference/search_species.html">search_species()</a></code>.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">collections</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/meta.html">meta_collections</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a></span><span class="op">(</span><span class="fu"><a href="../reference/meta.html">meta_collections</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/search_species.html">search_species</a></span><span class="op">(</span><span class="st">"wood duck"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## # A tibble: 5 × 5</span></span>
<span><span class="co">##   species_id scientific_name                    english_name                          french_name                           taxon_group</span></span>
<span><span class="co">##        &lt;int&gt; &lt;chr&gt;                              &lt;chr&gt;                                 &lt;chr&gt;                                 &lt;chr&gt;      </span></span>
<span><span class="co">## 1        360 Aix sponsa                         Wood Duck                             Canard branchu                        BIRDS      </span></span>
<span><span class="co">## 2      40938 Aix sponsa x Anas platyrhynchos    Wood Duck x Mallard (hybrid)          Hybride Canard branchu x C. colvert   BIRDS      </span></span>
<span><span class="co">## 3      41197 Aix sponsa x Lophodytes cucullatus Wood Duck x Hooded Merganser (hybrid) Hybride Canard branchu x Harle couro… BIRDS      </span></span>
<span><span class="co">## 4      45989 Aix sponsa x Mareca americana      Wood Duck x American Wigeon (hybrid)  Hybride Canard branchu x C. d'Amériq… BIRDS      </span></span>
<span><span class="co">## 5      47173 Tadorna tadorna x Aix sponsa       Common Shelduck x Wood Duck (hybrid)  Hybride Tadorne de Belon x Canard br… BIRDS</span></span></code></pre>
<p>Now we can download the NatureCounts data. Remember to change
<code>testuser</code> to your personal username.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">atlas_on</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nc_data_dl.html">nc_data_dl</a></span><span class="op">(</span>collections <span class="op">=</span> <span class="st">"OBBA2PC"</span>, species <span class="op">=</span> <span class="fl">360</span>, username <span class="op">=</span> <span class="st">"testuser"</span>, info <span class="op">=</span> <span class="st">"spatial_data_tutorial"</span><span class="op">)</span></span></code></pre></div>
<p>We can then convert our NatureCounts data into a spatial object. To
do so, we deploy the <code>st_as_sf</code> function and specify the
coordinate reference system (CRS).</p>
<p>The CRS of our KBA sf object can be returned with
<code><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs()</a></code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">ontario_kba</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Coordinate Reference System:</span></span>
<span><span class="co">##   User input: WGS 84 </span></span>
<span><span class="co">##   wkt:</span></span>
<span><span class="co">## GEOGCRS["WGS 84",</span></span>
<span><span class="co">##     DATUM["World Geodetic System 1984",</span></span>
<span><span class="co">##         ELLIPSOID["WGS 84",6378137,298.257223563,</span></span>
<span><span class="co">##             LENGTHUNIT["metre",1]]],</span></span>
<span><span class="co">##     PRIMEM["Greenwich",0,</span></span>
<span><span class="co">##         ANGLEUNIT["degree",0.0174532925199433]],</span></span>
<span><span class="co">##     CS[ellipsoidal,2],</span></span>
<span><span class="co">##         AXIS["latitude",north,</span></span>
<span><span class="co">##             ORDER[1],</span></span>
<span><span class="co">##             ANGLEUNIT["degree",0.0174532925199433]],</span></span>
<span><span class="co">##         AXIS["longitude",east,</span></span>
<span><span class="co">##             ORDER[2],</span></span>
<span><span class="co">##             ANGLEUNIT["degree",0.0174532925199433]],</span></span>
<span><span class="co">##     ID["EPSG",4326]]</span></span></code></pre>
<p>Our KBA sf object is stored with World Geodetic System 1984 (WGS 84)
coordinates, EPSG = 4326. Now we can convert our
<strong>atlas_on</strong> dataframe to an sf object using the same
CRS.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">atlas_on_sf</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">atlas_on</span>,</span>
<span>                        coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"longitude"</span>, <span class="st">"latitude"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span></code></pre></div>
<p>Now let’s ensure that the conversion was successful. You’ll notice a
new geometry column where each observation is a point.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">atlas_on_sf</span><span class="op">)</span> <span class="co"># view the sf object</span></span></code></pre></div>
<p>The <code><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform()</a></code> function can be applied to project
our spatial object using a different CRS like NAD83 / UTM zone 16N (EPSG
= 26916).</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ontario_kba</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">ontario_kba</span>, crs <span class="op">=</span> <span class="fl">26916</span><span class="op">)</span> </span></code></pre></div>
<p>It can also be used to ensure that the CRS of our spatial objects
match.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">atlas_on_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">atlas_on_sf</span>, crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">ontario_kba</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>To identify Wood Ducks observed across Ontario KBA’s, we can apply
the <code><a href="https://r-spatial.github.io/sf/reference/geos_binary_ops.html" class="external-link">st_intersection()</a></code> function.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wood_ducks_kba</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_ops.html" class="external-link">st_intersection</a></span><span class="op">(</span><span class="va">ontario_kba</span>, <span class="va">atlas_on_sf</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: attribute variables are assumed to be spatially constant throughout all geometries</span></span></code></pre>
<p>You will get a <code>warning</code> message, which you can safely
ignore.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># If need be, transform your spatial data back to EPSG:4326 to visualize with leaflet</span></span>
<span><span class="va">ontario_kba</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">ontario_kba</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span><span class="va">wood_ducks_kba</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">wood_ducks_kba</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span></code></pre></div>
<p>Using <code>ggplot</code>, we can visualize the polygon data and
point data.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Select a basemap</span></span>
<span>  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_map_tile.html" class="external-link">annotation_map_tile</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"osm"</span>, zoom <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Plot the filtered KBA polygon (ON001)</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ontario_kba</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Ontario KBA"</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.5</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Plot the Wood Duck observations that are within the KBA</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">wood_ducks_kba</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Wood Duck Observations"</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Custom fill and color for the legend</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ontario KBA"</span> <span class="op">=</span> <span class="st">"violet"</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Legend"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Wood Duck Observations"</span> <span class="op">=</span> <span class="st">"orange"</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Legend"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Automatically zoom to the extent of the ON001 polygon</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Map components</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottomright"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Key Biodiversity Area (KBA) - Long Point Peninsula and Marshes"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Latitude"</span><span class="op">)</span></span></code></pre></div>
<div class="float">
<img src="figure/longpoint_kba-1.png" alt="plot of chunk longpoint_kba"><div class="figcaption">plot of chunk longpoint_kba</div>
</div>
<pre><code>## 
  |                                                                                                                                   
  |                                                                                                                             |   0%
  |                                                                                                                                   
  |==============================================================                                                               |  50%
  |                                                                                                                                   
  |=============================================================================================================================| 100%</code></pre>
<div class="float">
<img src="figure/longpoint_kba-1.png" alt="plot of chunk longpoint_kba"><div class="figcaption">plot of chunk longpoint_kba</div>
</div>
<p>You can also apply <code>leaflet</code> to visualize the polygon data
and point data, using the <code><a href="https://rstudio.github.io/leaflet/reference/map-layers.html" class="external-link">addPolygons()</a></code>
<code><a href="https://rstudio.github.io/leaflet/reference/map-layers.html" class="external-link">addCircleMarkers()</a></code> arguments.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rstudio.github.io/leaflet/reference/leaflet.html" class="external-link">leaflet</a></span><span class="op">(</span>width <span class="op">=</span> <span class="st">"100%"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/map-layers.html" class="external-link">addTiles</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/map-layers.html" class="external-link">addPolygons</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">ontario_kba</span>, color <span class="op">=</span> <span class="st">"black"</span>, weight <span class="op">=</span> <span class="fl">2</span>, smoothFactor <span class="op">=</span> <span class="fl">1</span>, </span>
<span>  opacity <span class="op">=</span> <span class="fl">1.0</span>, fillOpacity <span class="op">=</span> <span class="fl">0.5</span>, fillColor <span class="op">=</span> <span class="st">"violet"</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/map-layers.html" class="external-link">addCircleMarkers</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">wood_ducks_kba</span>, radius <span class="op">=</span> <span class="fl">3</span>, color <span class="op">=</span> <span class="st">"orange"</span>, </span>
<span>                   stroke <span class="op">=</span> <span class="cn">FALSE</span>, fillOpacity <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://trafficonese.github.io/leaflet.extras/reference/fullscreen.html" class="external-link">addFullscreenControl</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rstudio.github.io/leaflet/reference/addLegend.html" class="external-link">addLegend</a></span><span class="op">(</span>colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"violet"</span>, <span class="st">"orange"</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ontario KBA"</span>, <span class="st">"Wood Duck Observations"</span><span class="op">)</span>, position <span class="op">=</span> <span class="st">"bottomright"</span><span class="op">)</span></span></code></pre></div>
<p>After geoprocessing our data, we can write out any sf objects to
Shapefiles on a disk, where the argument delete_layer = TRUE is used to
overwrite an existing file.</p>
<blockquote>
<p>To execute this code chunk, remove the #</p>
</blockquote>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># st_write(wood_ducks_kba,"wood_ducks_kba.shp", driver = "ESRI Shapefile", delete_layer = TRUE)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="priority-places">2.2 Priority Places<a class="anchor" aria-label="anchor" href="#priority-places"></a>
</h2>
<div class="section level5">
<h5 id="example-2b---you-want-to-assess-the-spatial-distribution-of-wood-ducks-ontario-breeding-bird-atlas-data-across-the-long-point-walsingham-forest-priority-place-">
<em>Example 2b</em> - You want to assess the spatial distribution of
Wood Ducks (Ontario Breeding Bird Atlas data) across the Long Point
Walsingham Forest Priority Place.<a class="anchor" aria-label="anchor" href="#example-2b---you-want-to-assess-the-spatial-distribution-of-wood-ducks-ontario-breeding-bird-atlas-data-across-the-long-point-walsingham-forest-priority-place-"></a>
</h5>
<p>Navigate to <a href="https://open.canada.ca/data/en/dataset/91219d24-e877-4c8a-8bd2-b2b662e573e0" class="external-link">Priority
Places - Open Government Portal</a>. Scroll down to the <strong>Data and
Resources</strong> section and select the Priority Places file labeled
<code>English</code>, <code>dataset</code>, and
<code>FGDB/GDB</code>.</p>
<p>First, lets create a path to our downloaded Priority Place file.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gdb_path</span> <span class="op">&lt;-</span> <span class="st">"PriorityPlaces.gdb"</span></span></code></pre></div>
<p>Then, let’s inspect the spatial data.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gdb_layers</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_layers.html" class="external-link">st_layers</a></span><span class="op">(</span><span class="va">gdb_path</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gdb_layers</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Driver: OpenFileGDB </span></span>
<span><span class="co">## Available layers:</span></span>
<span><span class="co">##               layer_name geometry_type features fields                     crs_name</span></span>
<span><span class="co">## 1 PriorityPlacesBoundary Multi Polygon       11     11 NAD83 / Canada Atlas Lambert</span></span>
<span><span class="co">## 2  PriorityPlacesProject   Multi Point       89     13 NAD83 / Canada Atlas Lambert</span></span></code></pre>
<p>To read in our spatial data object, we apply the <code>st_read</code>
function and specify our desired data layer.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">priori_place_polygons</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span>dsn <span class="op">=</span> <span class="va">gdb_path</span>, layer <span class="op">=</span> <span class="st">"PriorityPlacesBoundary"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Reading layer `PriorityPlacesBoundary' from data source `C:\Users\dimit\Birds Canada\Data\priority_places\priorityplaces.gdb' using driver `OpenFileGDB'</span></span>
<span><span class="co">## Simple feature collection with 11 features and 11 fields</span></span>
<span><span class="co">## Geometry type: MULTIPOLYGON</span></span>
<span><span class="co">## Dimension:     XY</span></span>
<span><span class="co">## Bounding box:  xmin: -2135754 ymin: -586679 xmax: 2450963 ymax: 2554209</span></span>
<span><span class="co">## Projected CRS: NAD83 / Canada Atlas Lambert</span></span></code></pre>
<p>Were interested in the spatial distribution of Wood Ducks across the
Long Point Walsingham Forest Priority Place. We’ll filter based on a
variable condition.</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">long_point_polygon</span> <span class="op">&lt;-</span> <span class="va">priori_place_polygons</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Name</span> <span class="op">==</span> <span class="st">"Long Point Walsingham Forest"</span><span class="op">)</span> <span class="co"># filters based on multipolygon name </span></span></code></pre></div>
<p>Then reproject the Wood Duck data to match our Priority Place using
<code>st_transform</code>.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">atlas_on_sf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">atlas_on_sf</span>, crs <span class="op">=</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_crs.html" class="external-link">st_crs</a></span><span class="op">(</span><span class="va">long_point_polygon</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Next, we’ll apply our geoprocessing function to find the Wood Duck
observations that intersect with our chosen Priority Place.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wood_ducks_longpoint</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_ops.html" class="external-link">st_intersection</a></span><span class="op">(</span><span class="va">long_point_polygon</span>, <span class="va">atlas_on_sf</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: attribute variables are assumed to be spatially constant throughout all geometries</span></span></code></pre>
<p>Finally, we’ll transform our spatial objects one more time before
visualizing them with <code>leaflet</code>.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">long_point_polygon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">long_point_polygon</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span><span class="va">wood_ducks_longpoint</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_transform.html" class="external-link">st_transform</a></span><span class="op">(</span><span class="va">wood_ducks_longpoint</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span></code></pre></div>
<p>Use <code>ggplot</code> to visualize the polygon and point data.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Select a basemap</span></span>
<span>  <span class="fu"><a href="https://paleolimbot.github.io/ggspatial/reference/annotation_map_tile.html" class="external-link">annotation_map_tile</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"cartolight"</span>, zoom <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Plot the Long Point polygon</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">long_point_polygon</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"Long Point Walsingham Forest"</span><span class="op">)</span>,  </span>
<span>          color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">0.5</span>, alpha <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Plot the Wood Duck observations</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">geom_sf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">wood_ducks_longpoint</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"Wood Duck Observations"</span><span class="op">)</span>, </span>
<span>          size <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Custom fill and color for the legend</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Long Point Walsingham Forest"</span> <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Legend"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Wood Duck Observations"</span> <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span>, name <span class="op">=</span> <span class="st">"Legend"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Automatically zoom to the extent of the Long Point polygon</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html" class="external-link">coord_sf</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># Map components</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottomright"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Wood Duck Observations within Long Point Walsingham"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"Longitude"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Latitude"</span><span class="op">)</span></span>
<span>       </span></code></pre></div>
<div class="float">
<img src="figure/longpoint_prioriplace-1.png" alt="plot of chunk longpoint_prioriplace"><div class="figcaption">plot of chunk longpoint_prioriplace</div>
</div>
<pre><code>

You can also apply leaflet to visualize our polygon data and point data, using the `addPolygons()` `addCircleMarkers()` arguments.
</code></pre>
<p>leaflet(width = “100%”) %&gt;% addTiles() %&gt;% addPolygons(data =
long_point_polygon, color = “black”, weight = 2, smoothFactor = 1,
opacity = 1.0, fillOpacity = 0.5, fillColor = “red”) %&gt;%
addCircleMarkers(data = wood_ducks_longpoint, radius = 5, color =
“green”, stroke = FALSE, fillOpacity = 0.8) %&gt;%
addFullscreenControl() %&gt;% addLegend(colors = c(“red”, “green”),
labels = c(“Long Point Walsingham Forest”, “Wood Duck Observations”),
position = “bottomright”)</p>
<pre><code>
After geoprocessing our data, we can write out any sf objects to Shapefiles on a disk, where the argument delete_layer = TRUE is used to overwrite an existing file.

&gt; To execute this code chunk, remove the \#


``` r
# st_write(wood_ducks_longpoint,"wood_ducks_longpoint.shp", driver = "ESRI Shapefile", delete_layer = TRUE)</code></pre>
<p><strong>Congratulations</strong>! You completed <strong>Chapter 2 -
Spatial Filtering: KBA’s and Priority Places</strong>. Here, you
successfully filtered and visualized NatureCounts data. In <a href="03-ClimateData.Rmd">Chapter 3</a>, you can explore more spatial
data visualization while linking climate data to NatureCounts
observations.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Steffi LaZerte, Denis Lepage.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
