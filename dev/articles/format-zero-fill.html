<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Zero-filling data • naturecounts</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Zero-filling data">
<meta name="robots" content="noindex">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-dark" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">naturecounts</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.4.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/BirdsCanada/naturecounts/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Zero-filling data</h1>
            
            <h4 data-toc-skip class="date">2024-11-21</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/BirdsCanada/naturecounts/blob/docs-update/vignettes/format-zero-fill.Rmd" class="external-link"><code>vignettes/format-zero-fill.Rmd</code></a></small>
      <div class="d-none name"><code>format-zero-fill.Rmd</code></div>
    </div>

    
    
<p>After downloading population data, many analyses require that you
have records not only of when/where species <em>were</em> detected, but
also where they <em>were not</em> detected. While NatureCounts generally
contains records of species presence, we can infer species absence when
a species was not detected in a Sampling Event (unique
<code>SamplingEventIdentifier</code>), provided that all species were
reported for that Sampling Event (i.e. that
<code>AllSpeciesReported</code> is “Yes”).</p>
<p>To make things simpler, we have included the
<code><a href="../reference/format_zero_fill.html">format_zero_fill()</a></code> function.</p>
<blockquote>
<p>The following examples use the “testuser” user which is not available
to you. You can quickly <a href="https://naturecounts.ca/nc/default/register.jsp" class="external-link">sign up for a
free account</a> of your own to access and play around with these
examples. Simply replace <code>testuser</code> with your own
username.</p>
</blockquote>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<div class="section level3">
<h3 id="packages">Packages<a class="anchor" aria-label="anchor" href="#packages"></a>
</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/BirdsCanada/naturecounts" class="external-link">naturecounts</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="download-data">Download data<a class="anchor" aria-label="anchor" href="#download-data"></a>
</h3>
<p>We’ll use the ‘core’ version of BMDE fields so that we include
<code>CommonName</code> for convenience.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nc_data_dl.html">nc_data_dl</a></span><span class="op">(</span>collections <span class="op">=</span> <span class="st">"RCBIOTABASE"</span>, fields_set <span class="op">=</span> <span class="st">"core"</span>,</span>
<span>                 species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">252456</span>, <span class="fl">252494</span>, <span class="fl">252491</span><span class="op">)</span>,</span>
<span>                 username <span class="op">=</span> <span class="st">"testuser"</span>, info <span class="op">=</span> <span class="st">"nc_vignette"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Using filters: collections (RCBIOTABASE); species (252456, 252494, 252491); fields_set (BMDE2.00)</span></span></code></pre>
<pre><code><span><span class="co">## Collecting available records...</span></span></code></pre>
<pre><code><span><span class="co">##    collection nrecords</span></span>
<span><span class="co">## 1 RCBIOTABASE      349</span></span>
<span><span class="co">## Total records: 349</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Downloading records for each collection:</span></span></code></pre>
<pre><code><span><span class="co">##   RCBIOTABASE</span></span></code></pre>
<pre><code><span><span class="co">##     Records 1 to 349 / 349</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="initial-exploration">Initial Exploration<a class="anchor" aria-label="anchor" href="#initial-exploration"></a>
</h3>
<p>Let’s take a look at the butterfly species observations we have</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">rc</span>, <span class="va">CommonName</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##          CommonName   n</span></span>
<span><span class="co">## 1 Black Swallowtail  40</span></span>
<span><span class="co">## 2           Monarch 215</span></span>
<span><span class="co">## 3       Red Admiral  94</span></span></code></pre>
<p>How many sampling events?</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">rc</span>, <span class="va">SamplingEventIdentifier</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##     SamplingEventIdentifier   n</span></span>
<span><span class="co">## 1       RCBIOTABASE-10008-1   1</span></span>
<span><span class="co">## 2       RCBIOTABASE-10015-1   1</span></span>
<span><span class="co">## 3       RCBIOTABASE-10030-1   1</span></span>
<span><span class="co">## 4       RCBIOTABASE-10068-1   1</span></span>
<span><span class="co">## 5       RCBIOTABASE-10070-1   1</span></span>
<span><span class="co">## 6       RCBIOTABASE-10087-1   1</span></span>
<span><span class="co">## 7       RCBIOTABASE-10093-1   2</span></span>
<span><span class="co">## 8       RCBIOTABASE-10097-1   1</span></span>
<span><span class="co">## 9       RCBIOTABASE-10104-1   1</span></span>
<span><span class="co">## 10      RCBIOTABASE-10110-1   1</span></span>
<span><span class="co">## 11      RCBIOTABASE-10112-1   1</span></span>
<span><span class="co">## 12      RCBIOTABASE-10144-1   1</span></span>
<span><span class="co">## 13      RCBIOTABASE-10146-1   1</span></span>
<span><span class="co">## 14      RCBIOTABASE-10217-1   1</span></span>
<span><span class="co">## 15      RCBIOTABASE-10224-1   1</span></span>
<span><span class="co">## 16      RCBIOTABASE-10225-1   1</span></span>
<span><span class="co">## 17      RCBIOTABASE-10236-1   1</span></span>
<span><span class="co">## 18      RCBIOTABASE-10241-1   1</span></span>
<span><span class="co">## 19      RCBIOTABASE-10249-1   1</span></span>
<span><span class="co">## 20      RCBIOTABASE-10250-1   1</span></span>
<span><span class="co">## 21      RCBIOTABASE-10258-1   1</span></span>
<span><span class="co">## 22      RCBIOTABASE-10261-1   1</span></span>
<span><span class="co">## 23      RCBIOTABASE-10263-1   1</span></span>
<span><span class="co">## 24      RCBIOTABASE-10264-1   1</span></span>
<span><span class="co">## 25      RCBIOTABASE-10279-1   1</span></span>
<span><span class="co">## 26      RCBIOTABASE-10282-1   1</span></span>
<span><span class="co">## 27      RCBIOTABASE-10283-1   1</span></span>
<span><span class="co">## 28      RCBIOTABASE-10284-1   1</span></span>
<span><span class="co">## 29      RCBIOTABASE-10286-1   3</span></span>
<span><span class="co">## 30      RCBIOTABASE-10296-1   1</span></span>
<span><span class="co">## 31      RCBIOTABASE-10297-1   1</span></span>
<span><span class="co">## 32      RCBIOTABASE-10304-1   1</span></span>
<span><span class="co">## 33      RCBIOTABASE-10305-1   2</span></span>
<span><span class="co">## 34      RCBIOTABASE-10309-1   1</span></span>
<span><span class="co">## 35      RCBIOTABASE-10310-1   1</span></span>
<span><span class="co">## 36      RCBIOTABASE-10311-1   1</span></span>
<span><span class="co">## 37      RCBIOTABASE-10313-1   1</span></span>
<span><span class="co">## 38      RCBIOTABASE-10323-1   1</span></span>
<span><span class="co">## 39      RCBIOTABASE-10757-1   3</span></span>
<span><span class="co">## 40      RCBIOTABASE-10758-1   3</span></span>
<span><span class="co">## 41      RCBIOTABASE-10759-1   1</span></span>
<span><span class="co">## 42      RCBIOTABASE-10760-1   2</span></span>
<span><span class="co">## 43      RCBIOTABASE-10761-1   1</span></span>
<span><span class="co">## 44      RCBIOTABASE-10762-1   3</span></span>
<span><span class="co">## 45      RCBIOTABASE-10765-1   1</span></span>
<span><span class="co">## 46      RCBIOTABASE-10766-1   2</span></span>
<span><span class="co">## 47      RCBIOTABASE-10767-1   1</span></span>
<span><span class="co">## 48      RCBIOTABASE-10768-1   1</span></span>
<span><span class="co">## 49      RCBIOTABASE-10769-1   3</span></span>
<span><span class="co">## 50      RCBIOTABASE-10770-1   1</span></span>
<span><span class="co">## 51      RCBIOTABASE-10771-1   2</span></span>
<span><span class="co">## 52      RCBIOTABASE-10772-1   1</span></span>
<span><span class="co">## 53      RCBIOTABASE-10773-1   2</span></span>
<span><span class="co">## 54      RCBIOTABASE-10774-1   2</span></span>
<span><span class="co">## 55      RCBIOTABASE-10775-1   1</span></span>
<span><span class="co">## 56      RCBIOTABASE-10776-1   2</span></span>
<span><span class="co">## 57      RCBIOTABASE-10777-1   2</span></span>
<span><span class="co">## 58      RCBIOTABASE-10778-1   1</span></span>
<span><span class="co">## 59      RCBIOTABASE-10779-1   2</span></span>
<span><span class="co">## 60      RCBIOTABASE-10782-1   2</span></span>
<span><span class="co">## 61      RCBIOTABASE-10783-1   1</span></span>
<span><span class="co">## 62      RCBIOTABASE-10784-1   3</span></span>
<span><span class="co">## 63      RCBIOTABASE-10785-1   2</span></span>
<span><span class="co">## 64      RCBIOTABASE-10786-1   2</span></span>
<span><span class="co">## 65      RCBIOTABASE-10787-1   2</span></span>
<span><span class="co">## 66      RCBIOTABASE-10788-1   3</span></span>
<span><span class="co">## 67      RCBIOTABASE-10789-1   1</span></span>
<span><span class="co">## 68      RCBIOTABASE-10790-1   2</span></span>
<span><span class="co">## 69      RCBIOTABASE-10791-1   1</span></span>
<span><span class="co">## 70      RCBIOTABASE-10792-1   2</span></span>
<span><span class="co">## 71      RCBIOTABASE-12276-1   1</span></span>
<span><span class="co">## 72      RCBIOTABASE-15494-1   1</span></span>
<span><span class="co">## 73       RCBIOTABASE-5545-1   2</span></span>
<span><span class="co">## 74       RCBIOTABASE-5546-1   1</span></span>
<span><span class="co">## 75       RCBIOTABASE-5547-1   1</span></span>
<span><span class="co">## 76       RCBIOTABASE-5553-1   2</span></span>
<span><span class="co">## 77       RCBIOTABASE-6235-1   1</span></span>
<span><span class="co">## 78       RCBIOTABASE-7544-1   1</span></span>
<span><span class="co">## 79       RCBIOTABASE-7706-1   1</span></span>
<span><span class="co">## 80       RCBIOTABASE-7862-1   1</span></span>
<span><span class="co">## 81       RCBIOTABASE-8221-1   1</span></span>
<span><span class="co">## 82       RCBIOTABASE-9148-1   2</span></span>
<span><span class="co">## 83       RCBIOTABASE-9149-1   1</span></span>
<span><span class="co">## 84       RCBIOTABASE-9150-1   2</span></span>
<span><span class="co">## 85       RCBIOTABASE-9151-1   2</span></span>
<span><span class="co">## 86       RCBIOTABASE-9152-1   2</span></span>
<span><span class="co">## 87       RCBIOTABASE-9379-1   1</span></span>
<span><span class="co">## 88       RCBIOTABASE-9383-1   1</span></span>
<span><span class="co">## 89       RCBIOTABASE-9390-1   1</span></span>
<span><span class="co">## 90       RCBIOTABASE-9394-1   1</span></span>
<span><span class="co">## 91       RCBIOTABASE-9419-1   1</span></span>
<span><span class="co">## 92       RCBIOTABASE-9421-1   1</span></span>
<span><span class="co">## 93       RCBIOTABASE-9423-1   1</span></span>
<span><span class="co">## 94       RCBIOTABASE-9424-1   1</span></span>
<span><span class="co">## 95       RCBIOTABASE-9425-1   1</span></span>
<span><span class="co">## 96       RCBIOTABASE-9426-1   1</span></span>
<span><span class="co">## 97       RCBIOTABASE-9427-1   1</span></span>
<span><span class="co">## 98       RCBIOTABASE-9589-1   2</span></span>
<span><span class="co">## 99       RCBIOTABASE-9590-1   2</span></span>
<span><span class="co">## 100      RCBIOTABASE-9591-1   1</span></span>
<span><span class="co">## 101      RCBIOTABASE-9592-1   1</span></span>
<span><span class="co">## 102      RCBIOTABASE-9595-1   2</span></span>
<span><span class="co">## 103      RCBIOTABASE-9596-1   1</span></span>
<span><span class="co">## 104      RCBIOTABASE-9597-1   2</span></span>
<span><span class="co">## 105      RCBIOTABASE-9643-1   1</span></span>
<span><span class="co">## 106      RCBIOTABASE-9645-1   1</span></span>
<span><span class="co">## 107      RCBIOTABASE-9716-1   1</span></span>
<span><span class="co">## 108      RCBIOTABASE-9784-1   1</span></span>
<span><span class="co">## 109      RCBIOTABASE-9787-1   1</span></span>
<span><span class="co">## 110      RCBIOTABASE-9793-1   1</span></span>
<span><span class="co">## 111      RCBIOTABASE-9798-1   1</span></span>
<span><span class="co">## 112      RCBIOTABASE-9801-1   2</span></span>
<span><span class="co">## 113      RCBIOTABASE-9802-1   1</span></span>
<span><span class="co">## 114      RCBIOTABASE-9805-1   1</span></span>
<span><span class="co">## 115      RCBIOTABASE-9806-1   1</span></span>
<span><span class="co">## 116      RCBIOTABASE-9807-1   1</span></span>
<span><span class="co">## 117      RCBIOTABASE-9811-1   2</span></span>
<span><span class="co">## 118      RCBIOTABASE-9822-1   1</span></span>
<span><span class="co">## 119      RCBIOTABASE-9833-1   1</span></span>
<span><span class="co">## 120      RCBIOTABASE-9879-1   1</span></span>
<span><span class="co">## 121      RCBIOTABASE-9880-1   1</span></span>
<span><span class="co">## 122      RCBIOTABASE-9882-1   1</span></span>
<span><span class="co">## 123      RCBIOTABASE-9888-1   1</span></span>
<span><span class="co">## 124      RCBIOTABASE-9889-1   1</span></span>
<span><span class="co">## 125      RCBIOTABASE-9904-1   1</span></span>
<span><span class="co">## 126      RCBIOTABASE-9925-1   1</span></span>
<span><span class="co">## 127      RCBIOTABASE-9945-1   1</span></span>
<span><span class="co">## 128      RCBIOTABASE-9946-1   1</span></span>
<span><span class="co">## 129      RCBIOTABASE-9947-1   2</span></span>
<span><span class="co">## 130      RCBIOTABASE-9951-1   1</span></span>
<span><span class="co">## 131                    &lt;NA&gt; 176</span></span></code></pre>
<p>Lot’s of sampling events too. But some are missing
(<code>NA</code>).</p>
<p>Were all species reported?</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">rc</span>, <span class="va">AllSpeciesReported</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   AllSpeciesReported   n</span></span>
<span><span class="co">## 1                 No 176</span></span>
<span><span class="co">## 2                Yes 173</span></span></code></pre>
<p>Sometimes, but not all the time.</p>
<p>Finally, let’s take a peak at the observations recorded for these
three species</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rc</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CommonName</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">ObservationCount</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="external-link">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Number of individuals observed"</span><span class="op">)</span></span></code></pre></div>
<p><img src="format-zero-fill_files/figure-html/unnamed-chunk-6-1.png" alt="Boxplots showing counts for three butterflies, Monarchs showing the most" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rc</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CommonName</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Number of sampling events the species was observed"</span><span class="op">)</span></span></code></pre></div>
<p><img src="format-zero-fill_files/figure-html/unnamed-chunk-7-1.png" alt="Barplots showing counts for number of sampling events, Monarchs again showed the most" width="700"></p>
<p>To better understand these populations, it would be helpful to know
not only when these species were observed, but also when they were
not.</p>
</div>
</div>
<div class="section level2">
<h2 id="zero-filling">Zero-Filling<a class="anchor" aria-label="anchor" href="#zero-filling"></a>
</h2>
<p>Because zero-filling requires that all species are reported (how can
you know if a species was or was not observed, if it wasn’t reported?),
<code>format_zero_fill</code> will return an error if some of the
records are not valid.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rc_filled</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_zero_fill.html">format_zero_fill</a></span><span class="op">(</span><span class="va">rc</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Error: Column 'AllSpeciesReported' must be present and 'Yes'</span></span></code></pre>
<p>Therefore, the first thing we need to do is limit our data to only
<code>SamplingEventIdentifiers</code> where all species were
recorded.</p>
<p><strong>Note</strong> that <code>AllSpeciesReported</code> may not
always be strictly true, as bird identification events (e.g., Christmas
Bird Counts) may report all <em>bird</em> species, but would probably
not report all mammalian species, plants, etc. and vice versa.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rc_all_species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">rc</span>, <span class="va">AllSpeciesReported</span> <span class="op">==</span> <span class="st">"Yes"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">rc_all_species</span>, <span class="va">AllSpeciesReported</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   AllSpeciesReported   n</span></span>
<span><span class="co">## 1                Yes 173</span></span></code></pre>
<p>Now we can fill in all species missing from other sampling
events.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rc_filled</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_zero_fill.html">format_zero_fill</a></span><span class="op">(</span><span class="va">rc_all_species</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  - Converted 'fill' column (ObservationCount) from character to numeric</span></span></code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rc_filled</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   SamplingEventIdentifier species_id ObservationCount</span></span>
<span><span class="co">## 1     RCBIOTABASE-10008-1     252456                1</span></span>
<span><span class="co">## 2     RCBIOTABASE-10008-1     252491                0</span></span>
<span><span class="co">## 3     RCBIOTABASE-10008-1     252494                0</span></span>
<span><span class="co">## 4     RCBIOTABASE-10015-1     252456                2</span></span>
<span><span class="co">## 5     RCBIOTABASE-10015-1     252491                0</span></span>
<span><span class="co">## 6     RCBIOTABASE-10015-1     252494                0</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rc_filled</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">species_id</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">ObservationCount</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="external-link">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Number of sampling events the species was observed"</span><span class="op">)</span></span></code></pre></div>
<p><img src="format-zero-fill_files/figure-html/unnamed-chunk-11-1.png" alt="Barplot showing number of sampling events across three species. Pink bars show the counts for events with 0 observations, blue show the counts for those with &gt;0 observations." width="700"></p>
<p>It might be more helpful to use common names, but through the process
of zero-filling, extra columns have been removed.</p>
</div>
<div class="section level2">
<h2 id="keep-other-important-columns">Keep other important columns<a class="anchor" aria-label="anchor" href="#keep-other-important-columns"></a>
</h2>
<p>To keep other columns associated with species id, specify them with
the <code>extra_species</code> argument.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rc_filled</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_zero_fill.html">format_zero_fill</a></span><span class="op">(</span><span class="va">rc_all_species</span>, </span>
<span>                              extra_species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CommonName"</span>, <span class="st">"ScientificName"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  - Converted 'fill' column (ObservationCount) from character to numeric</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rc_filled</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   SamplingEventIdentifier species_id ObservationCount        CommonName</span></span>
<span><span class="co">## 1     RCBIOTABASE-10008-1     252456                1           Monarch</span></span>
<span><span class="co">## 2     RCBIOTABASE-10008-1     252491                0       Red Admiral</span></span>
<span><span class="co">## 3     RCBIOTABASE-10008-1     252494                0 Black Swallowtail</span></span>
<span><span class="co">## 4     RCBIOTABASE-10015-1     252456                2           Monarch</span></span>
<span><span class="co">## 5     RCBIOTABASE-10015-1     252491                0       Red Admiral</span></span>
<span><span class="co">## 6     RCBIOTABASE-10015-1     252494                0 Black Swallowtail</span></span>
<span><span class="co">##      ScientificName</span></span>
<span><span class="co">## 1  Danaus plexippus</span></span>
<span><span class="co">## 2  Vanessa atalanta</span></span>
<span><span class="co">## 3 Papilio polyxenes</span></span>
<span><span class="co">## 4  Danaus plexippus</span></span>
<span><span class="co">## 5  Vanessa atalanta</span></span>
<span><span class="co">## 6 Papilio polyxenes</span></span></code></pre>
<p>To keep other columns associated with the sampling event, specify
them, in addition to the sampling event id, in the <code>by</code>
argument. By default, <code>SamplingEventIdentifier</code> is used to
identify specific sampling events.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rc_filled</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_zero_fill.html">format_zero_fill</a></span><span class="op">(</span><span class="va">rc_all_species</span>, </span>
<span>                              by <span class="op">=</span> <span class="st">"SamplingEventIdentifier"</span>,</span>
<span>                              extra_event <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"latitude"</span>, <span class="st">"longitude"</span><span class="op">)</span>,</span>
<span>                              extra_species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CommonName"</span>, <span class="st">"ScientificName"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  - Converted 'fill' column (ObservationCount) from character to numeric</span></span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rc_filled</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   SamplingEventIdentifier species_id ObservationCount        CommonName</span></span>
<span><span class="co">## 1     RCBIOTABASE-10008-1     252456                1           Monarch</span></span>
<span><span class="co">## 2     RCBIOTABASE-10008-1     252491                0       Red Admiral</span></span>
<span><span class="co">## 3     RCBIOTABASE-10008-1     252494                0 Black Swallowtail</span></span>
<span><span class="co">## 4     RCBIOTABASE-10015-1     252456                2           Monarch</span></span>
<span><span class="co">## 5     RCBIOTABASE-10015-1     252491                0       Red Admiral</span></span>
<span><span class="co">## 6     RCBIOTABASE-10015-1     252494                0 Black Swallowtail</span></span>
<span><span class="co">##      ScientificName latitude longitude</span></span>
<span><span class="co">## 1  Danaus plexippus  45.5111 -77.50533</span></span>
<span><span class="co">## 2  Vanessa atalanta  45.5111 -77.50533</span></span>
<span><span class="co">## 3 Papilio polyxenes  45.5111 -77.50533</span></span>
<span><span class="co">## 4  Danaus plexippus  45.5111 -77.50533</span></span>
<span><span class="co">## 5  Vanessa atalanta  45.5111 -77.50533</span></span>
<span><span class="co">## 6 Papilio polyxenes  45.5111 -77.50533</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="zero-filling-by-other-variables">Zero-filling <code>by</code> other variables<a class="anchor" aria-label="anchor" href="#zero-filling-by-other-variables"></a>
</h2>
<p>Sampling events aren’t the only way of zero-filling data. Perhaps
you’re only interested in whether a species has/has not been observed in
a particular location.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rc_loc_filled</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_zero_fill.html">format_zero_fill</a></span><span class="op">(</span><span class="va">rc_all_species</span>, </span>
<span>                                  by <span class="op">=</span> <span class="st">"utm_square"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  - Consider summarizing multiple observations per set of 'by' before zero-filling to increase speed</span></span></code></pre>
<pre><code><span><span class="co">##  - Converted 'fill' column (ObservationCount) from character to numeric</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rc_loc_filled</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   utm_square species_id ObservationCount</span></span>
<span><span class="co">## 1    18TTR94     252456                1</span></span>
<span><span class="co">## 2    18TTR94     252491                0</span></span>
<span><span class="co">## 3    18TTR94     252494                0</span></span>
<span><span class="co">## 4    18TUR04     252456                1</span></span>
<span><span class="co">## 5    18TUR04     252456                1</span></span>
<span><span class="co">## 6    18TUR04     252456                1</span></span></code></pre>
<p>The message about summarizing multiple observations means that we
have multiple observations per <code>utm_square</code>. This example
isn’t large enough to be slowed down much, but in larger examples, it
can be much faster to simplify the dataset first.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rc_sum</span> <span class="op">&lt;-</span> <span class="va">rc_all_species</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">utm_square</span>, <span class="va">species_id</span>, <span class="va">AllSpeciesReported</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>ObservationCount <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">ObservationCount</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>            .groups <span class="op">=</span> <span class="st">"drop"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rc_sum</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">##   utm_square species_id AllSpeciesReported ObservationCount</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> 18TTR94        <span style="text-decoration: underline;">252</span>456 Yes                               1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> 18TUR04        <span style="text-decoration: underline;">252</span>456 Yes                              67</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span> 18TUR04        <span style="text-decoration: underline;">252</span>491 Yes                              46</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">4</span> 18TUR04        <span style="text-decoration: underline;">252</span>494 Yes                              22</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">5</span> 18TUR17        <span style="text-decoration: underline;">252</span>456 Yes                               1</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">6</span> 18TUR27        <span style="text-decoration: underline;">252</span>491 Yes                               1</span></span></code></pre>
<p>Now if we zero-fill this data set, we get a zero-filled, aggregated
dataset.</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rc_sum_filled</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_zero_fill.html">format_zero_fill</a></span><span class="op">(</span><span class="va">rc_sum</span>, by <span class="op">=</span> <span class="st">"utm_square"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rc_sum_filled</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   utm_square species_id ObservationCount</span></span>
<span><span class="co">## 1    18TTR94     252456                1</span></span>
<span><span class="co">## 2    18TTR94     252491                0</span></span>
<span><span class="co">## 3    18TTR94     252494                0</span></span>
<span><span class="co">## 4    18TUR04     252456               67</span></span>
<span><span class="co">## 5    18TUR04     252491               46</span></span>
<span><span class="co">## 6    18TUR04     252494               22</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="filling-specific-species">Filling specific species<a class="anchor" aria-label="anchor" href="#filling-specific-species"></a>
</h2>
<p>Up to now in these examples we’ve been filling all the species
present in the data, but often you might be only interested in one or
two species. We can specify which species with the <code>species</code>
argument.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rc_sp_filled</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_zero_fill.html">format_zero_fill</a></span><span class="op">(</span><span class="va">rc_all_species</span>, species <span class="op">=</span> <span class="st">"252456"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  - Converted 'fill' column (ObservationCount) from character to numeric</span></span></code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rc_sp_filled</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   SamplingEventIdentifier species_id ObservationCount</span></span>
<span><span class="co">## 1     RCBIOTABASE-10008-1     252456                1</span></span>
<span><span class="co">## 2     RCBIOTABASE-10015-1     252456                2</span></span>
<span><span class="co">## 3     RCBIOTABASE-10030-1     252456                0</span></span>
<span><span class="co">## 4     RCBIOTABASE-10068-1     252456                0</span></span>
<span><span class="co">## 5     RCBIOTABASE-10070-1     252456                2</span></span>
<span><span class="co">## 6     RCBIOTABASE-10087-1     252456                0</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="filling-other-variables">Filling other variables<a class="anchor" aria-label="anchor" href="#filling-other-variables"></a>
</h2>
<p>By default <code><a href="../reference/format_zero_fill.html">format_zero_fill()</a></code> adds 0’s to the
<code>ObservationCount</code> column, but you can specify any column to
zero fill.</p>
<p>For example, if you wanted to deal only with Presence/Absence you
could create a new <code>presence</code> column and zero-fill this
column.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rc_presence</span> <span class="op">&lt;-</span> <span class="va">rc_all_species</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">species_id</span>, <span class="va">AllSpeciesReported</span>, <span class="va">ObservationCount</span>, <span class="va">SamplingEventIdentifier</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>presence <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">ObservationCount</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rc_presence</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   species_id AllSpeciesReported ObservationCount SamplingEventIdentifier</span></span>
<span><span class="co">## 1     252456                Yes                6      RCBIOTABASE-5553-1</span></span>
<span><span class="co">## 2     252491                Yes                1      RCBIOTABASE-5553-1</span></span>
<span><span class="co">## 3     252456                Yes                2      RCBIOTABASE-5547-1</span></span>
<span><span class="co">## 4     252456                Yes                1      RCBIOTABASE-5546-1</span></span>
<span><span class="co">## 5     252494                Yes                1      RCBIOTABASE-6235-1</span></span>
<span><span class="co">## 6     252491                Yes                3      RCBIOTABASE-5545-1</span></span>
<span><span class="co">##   presence</span></span>
<span><span class="co">## 1     TRUE</span></span>
<span><span class="co">## 2     TRUE</span></span>
<span><span class="co">## 3     TRUE</span></span>
<span><span class="co">## 4     TRUE</span></span>
<span><span class="co">## 5     TRUE</span></span>
<span><span class="co">## 6     TRUE</span></span></code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rc_presence_filled</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_zero_fill.html">format_zero_fill</a></span><span class="op">(</span><span class="va">rc_presence</span>, fill <span class="op">=</span> <span class="st">"presence"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  - Converted 'fill' column (presence) from logical to numeric</span></span></code></pre>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rc_presence_filled</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##   SamplingEventIdentifier species_id presence</span></span>
<span><span class="co">## 1     RCBIOTABASE-10008-1     252456        1</span></span>
<span><span class="co">## 2     RCBIOTABASE-10008-1     252491        0</span></span>
<span><span class="co">## 3     RCBIOTABASE-10008-1     252494        0</span></span>
<span><span class="co">## 4     RCBIOTABASE-10015-1     252456        1</span></span>
<span><span class="co">## 5     RCBIOTABASE-10015-1     252491        0</span></span>
<span><span class="co">## 6     RCBIOTABASE-10015-1     252494        0</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Steffi LaZerte, Denis Lepage.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
