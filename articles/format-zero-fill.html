<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zero-filling data • naturecounts</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/sandstone/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Zero-filling data">
<meta property="og:description" content="naturecounts">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">naturecounts</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/BirdStudiesCanada/naturecounts">
    <span class="fas fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="format-zero-fill_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Zero-filling data</h1>
            
            <h4 class="date">2021-03-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/BirdStudiesCanada/naturecounts/blob/master/vignettes/format-zero-fill.Rmd"><code>vignettes/format-zero-fill.Rmd</code></a></small>
      <div class="hidden name"><code>format-zero-fill.Rmd</code></div>

    </div>

    
    
<p>After downloading population data, many analyses require that you have records not only of when/where species <em>were</em> detected, but also where they <em>were not</em> detected. While NatureCounts generally contains records of species presence, we can infer species absence when a species was not detected in a Sampling Event (unique <code>SamplingEventIdentifier</code>), provided that all species were reported for that Sampling Event (i.e. that <code>AllSpeciesReported</code> is “Yes”).</p>
<p>To make things simpler, we have included the <code><a href="../reference/format_zero_fill.html">format_zero_fill()</a></code> function.</p>
<blockquote>
<p>The following examples use the “testuser” user which is not available to you. You can quickly <a href="https://www.birdscanada.org/birdmon/default/register.jsp">sign up for a free account</a> of your own to access and play around with these examples.</p>
</blockquote>
<div id="setup" class="section level2">
<h2 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h2>
<div id="packages" class="section level3">
<h3 class="hasAnchor">
<a href="#packages" class="anchor"></a>Packages</h3>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/BirdStudiesCanada/naturecounts">naturecounts</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dkahle/ggmap">ggmap</a></span><span class="op">)</span></code></pre></div>
</div>
<div id="download-data" class="section level3">
<h3 class="hasAnchor">
<a href="#download-data" class="anchor"></a>Download data</h3>
<p>We’ll use the ‘core’ version of BMDE fields so that we include <code>CommonName</code> for convenience.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rc</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nc_data_dl.html">nc_data_dl</a></span><span class="op">(</span>collections <span class="op">=</span> <span class="st">"RCBIOTABASE"</span>, fields_set <span class="op">=</span> <span class="st">"core"</span>,
                 species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">252456</span>, <span class="fl">252494</span>, <span class="fl">252491</span><span class="op">)</span>,
                 username <span class="op">=</span> <span class="st">"testuser"</span>, info <span class="op">=</span> <span class="st">"nc_vignette"</span><span class="op">)</span></code></pre></div>
<pre><code>## Using filters: collections (RCBIOTABASE); species (252456, 252494, 252491); fields_set (BMDE2.00)</code></pre>
<pre><code>## Collecting available records...</code></pre>
<pre><code>##    collection nrecords
## 1 RCBIOTABASE      349
## Total records: 349</code></pre>
<pre><code>## 
## Downloading records for each collection:</code></pre>
<pre><code>##   RCBIOTABASE</code></pre>
<pre><code>##     Records 1 to 349 / 349</code></pre>
</div>
<div id="initial-exploration" class="section level3">
<h3 class="hasAnchor">
<a href="#initial-exploration" class="anchor"></a>Initial Exploration</h3>
<p>Let’s take a look at the butterfly species observations we have</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">rc</span>, <span class="va">CommonName</span><span class="op">)</span></code></pre></div>
<pre><code>##          CommonName   n
## 1 Black Swallowtail  40
## 2           Monarch 215
## 3       Red Admiral  94</code></pre>
<p>How many sampling events?</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">rc</span>, <span class="va">SamplingEventIdentifier</span><span class="op">)</span></code></pre></div>
<pre><code>##     SamplingEventIdentifier   n
## 1       RCBIOTABASE-10008-1   1
## 2       RCBIOTABASE-10015-1   1
## 3       RCBIOTABASE-10030-1   1
## 4       RCBIOTABASE-10068-1   1
## 5       RCBIOTABASE-10070-1   1
## 6       RCBIOTABASE-10087-1   1
## 7       RCBIOTABASE-10093-1   2
## 8       RCBIOTABASE-10097-1   1
## 9       RCBIOTABASE-10104-1   1
## 10      RCBIOTABASE-10110-1   1
## 11      RCBIOTABASE-10112-1   1
## 12      RCBIOTABASE-10144-1   1
## 13      RCBIOTABASE-10146-1   1
## 14      RCBIOTABASE-10217-1   1
## 15      RCBIOTABASE-10224-1   1
## 16      RCBIOTABASE-10225-1   1
## 17      RCBIOTABASE-10236-1   1
## 18      RCBIOTABASE-10241-1   1
## 19      RCBIOTABASE-10249-1   1
## 20      RCBIOTABASE-10250-1   1
## 21      RCBIOTABASE-10258-1   1
## 22      RCBIOTABASE-10261-1   1
## 23      RCBIOTABASE-10263-1   1
## 24      RCBIOTABASE-10264-1   1
## 25      RCBIOTABASE-10279-1   1
## 26      RCBIOTABASE-10282-1   1
## 27      RCBIOTABASE-10283-1   1
## 28      RCBIOTABASE-10284-1   1
## 29      RCBIOTABASE-10286-1   3
## 30      RCBIOTABASE-10296-1   1
## 31      RCBIOTABASE-10297-1   1
## 32      RCBIOTABASE-10304-1   1
## 33      RCBIOTABASE-10305-1   2
## 34      RCBIOTABASE-10309-1   1
## 35      RCBIOTABASE-10310-1   1
## 36      RCBIOTABASE-10311-1   1
## 37      RCBIOTABASE-10313-1   1
## 38      RCBIOTABASE-10323-1   1
## 39      RCBIOTABASE-10757-1   3
## 40      RCBIOTABASE-10758-1   3
## 41      RCBIOTABASE-10759-1   1
## 42      RCBIOTABASE-10760-1   2
## 43      RCBIOTABASE-10761-1   1
## 44      RCBIOTABASE-10762-1   3
## 45      RCBIOTABASE-10765-1   1
## 46      RCBIOTABASE-10766-1   2
## 47      RCBIOTABASE-10767-1   1
## 48      RCBIOTABASE-10768-1   1
## 49      RCBIOTABASE-10769-1   3
## 50      RCBIOTABASE-10770-1   1
## 51      RCBIOTABASE-10771-1   2
## 52      RCBIOTABASE-10772-1   1
## 53      RCBIOTABASE-10773-1   2
## 54      RCBIOTABASE-10774-1   2
## 55      RCBIOTABASE-10775-1   1
## 56      RCBIOTABASE-10776-1   2
## 57      RCBIOTABASE-10777-1   2
## 58      RCBIOTABASE-10778-1   1
## 59      RCBIOTABASE-10779-1   2
## 60      RCBIOTABASE-10782-1   2
## 61      RCBIOTABASE-10783-1   1
## 62      RCBIOTABASE-10784-1   3
## 63      RCBIOTABASE-10785-1   2
## 64      RCBIOTABASE-10786-1   2
## 65      RCBIOTABASE-10787-1   2
## 66      RCBIOTABASE-10788-1   3
## 67      RCBIOTABASE-10789-1   1
## 68      RCBIOTABASE-10790-1   2
## 69      RCBIOTABASE-10791-1   1
## 70      RCBIOTABASE-10792-1   2
## 71      RCBIOTABASE-12276-1   1
## 72      RCBIOTABASE-15494-1   1
## 73       RCBIOTABASE-5545-1   2
## 74       RCBIOTABASE-5546-1   1
## 75       RCBIOTABASE-5547-1   1
## 76       RCBIOTABASE-5553-1   2
## 77       RCBIOTABASE-6235-1   1
## 78       RCBIOTABASE-7544-1   1
## 79       RCBIOTABASE-7706-1   1
## 80       RCBIOTABASE-7862-1   1
## 81       RCBIOTABASE-8221-1   1
## 82       RCBIOTABASE-9148-1   2
## 83       RCBIOTABASE-9149-1   1
## 84       RCBIOTABASE-9150-1   2
## 85       RCBIOTABASE-9151-1   2
## 86       RCBIOTABASE-9152-1   2
## 87       RCBIOTABASE-9379-1   1
## 88       RCBIOTABASE-9383-1   1
## 89       RCBIOTABASE-9390-1   1
## 90       RCBIOTABASE-9394-1   1
## 91       RCBIOTABASE-9419-1   1
## 92       RCBIOTABASE-9421-1   1
## 93       RCBIOTABASE-9423-1   1
## 94       RCBIOTABASE-9424-1   1
## 95       RCBIOTABASE-9425-1   1
## 96       RCBIOTABASE-9426-1   1
## 97       RCBIOTABASE-9427-1   1
## 98       RCBIOTABASE-9589-1   2
## 99       RCBIOTABASE-9590-1   2
## 100      RCBIOTABASE-9591-1   1
## 101      RCBIOTABASE-9592-1   1
## 102      RCBIOTABASE-9595-1   2
## 103      RCBIOTABASE-9596-1   1
## 104      RCBIOTABASE-9597-1   2
## 105      RCBIOTABASE-9643-1   1
## 106      RCBIOTABASE-9645-1   1
## 107      RCBIOTABASE-9716-1   1
## 108      RCBIOTABASE-9784-1   1
## 109      RCBIOTABASE-9787-1   1
## 110      RCBIOTABASE-9793-1   1
## 111      RCBIOTABASE-9798-1   1
## 112      RCBIOTABASE-9801-1   2
## 113      RCBIOTABASE-9802-1   1
## 114      RCBIOTABASE-9805-1   1
## 115      RCBIOTABASE-9806-1   1
## 116      RCBIOTABASE-9807-1   1
## 117      RCBIOTABASE-9811-1   2
## 118      RCBIOTABASE-9822-1   1
## 119      RCBIOTABASE-9833-1   1
## 120      RCBIOTABASE-9879-1   1
## 121      RCBIOTABASE-9880-1   1
## 122      RCBIOTABASE-9882-1   1
## 123      RCBIOTABASE-9888-1   1
## 124      RCBIOTABASE-9889-1   1
## 125      RCBIOTABASE-9904-1   1
## 126      RCBIOTABASE-9925-1   1
## 127      RCBIOTABASE-9945-1   1
## 128      RCBIOTABASE-9946-1   1
## 129      RCBIOTABASE-9947-1   2
## 130      RCBIOTABASE-9951-1   1
## 131                    &lt;NA&gt; 176</code></pre>
<p>Lot’s of sampling events too. But some are missing (<code>NA</code>).</p>
<p>Were all species reported?</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">rc</span>, <span class="va">AllSpeciesReported</span><span class="op">)</span></code></pre></div>
<pre><code>##   AllSpeciesReported   n
## 1                 No 176
## 2                Yes 173</code></pre>
<p>Sometimes, but not all the time.</p>
<p>Finally, let’s take a peak at the observations recorded for these three species</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rc</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CommonName</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">ObservationCount</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Number of individuals observed"</span><span class="op">)</span></code></pre></div>
<p><img src="format-zero-fill_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rc</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">CommonName</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Number of sampling events the species was observed"</span><span class="op">)</span></code></pre></div>
<p><img src="format-zero-fill_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<p>To better understand these populations, it would be helpful to know not only when these species were observed, but also when they were not.</p>
</div>
</div>
<div id="zero-filling" class="section level2">
<h2 class="hasAnchor">
<a href="#zero-filling" class="anchor"></a>Zero-Filling</h2>
<p>Because zero-filling requires that all species are reported (how can you know if a species was or was not observed, if it wasn’t reported?), <code>format_zero_fill</code> will return an error if some of the records are not valid.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rc_filled</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_zero_fill.html">format_zero_fill</a></span><span class="op">(</span><span class="va">rc</span><span class="op">)</span></code></pre></div>
<pre><code>## Error: Column 'AllSpeciesReported' must be present and 'Yes'</code></pre>
<p>Therefore, the first thing we need to do is limit our data to only <code>SamplingEventIdentifiers</code> where all species were recorded.</p>
<p><strong>Note</strong> that <code>AllSpeciesReported</code> may not always be strictly true, as bird identification events (e.g., Christmas Bird Counts) may report all <em>bird</em> species, but would probably not report all mammalian species, plants, etc. and vice versa.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rc_all_species</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">rc</span>, <span class="va">AllSpeciesReported</span> <span class="op">==</span> <span class="st">"Yes"</span><span class="op">)</span>
<span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html">count</a></span><span class="op">(</span><span class="va">rc_all_species</span>, <span class="va">AllSpeciesReported</span><span class="op">)</span></code></pre></div>
<pre><code>##   AllSpeciesReported   n
## 1                Yes 173</code></pre>
<p>Now we can fill in all species missing from other sampling events.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rc_filled</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_zero_fill.html">format_zero_fill</a></span><span class="op">(</span><span class="va">rc_all_species</span><span class="op">)</span></code></pre></div>
<pre><code>##  - Converted 'fill' column (ObservationCount) from character to numeric</code></pre>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">rc_filled</span><span class="op">)</span></code></pre></div>
<pre><code>##   SamplingEventIdentifier species_id ObservationCount
## 1     RCBIOTABASE-10008-1     252456                1
## 2     RCBIOTABASE-10008-1     252491                0
## 3     RCBIOTABASE-10008-1     252494                0
## 4     RCBIOTABASE-10015-1     252456                2
## 5     RCBIOTABASE-10015-1     252491                0
## 6     RCBIOTABASE-10015-1     252494                0</code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">rc_filled</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">species_id</span><span class="op">)</span>, fill <span class="op">=</span> <span class="va">ObservationCount</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Number of sampling events the species was observed"</span><span class="op">)</span></code></pre></div>
<p><img src="format-zero-fill_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>It might be more helpful to use common names, but through the process of zero-filling, extra columns have been removed.</p>
</div>
<div id="keep-other-important-columns" class="section level2">
<h2 class="hasAnchor">
<a href="#keep-other-important-columns" class="anchor"></a>Keep other important columns</h2>
<p>To keep other columns associated with species id, specify them with the <code>extra_species</code> argument.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rc_filled</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_zero_fill.html">format_zero_fill</a></span><span class="op">(</span><span class="va">rc_all_species</span>, 
                              extra_species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CommonName"</span>, <span class="st">"ScientificName"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  - Converted 'fill' column (ObservationCount) from character to numeric</code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">rc_filled</span><span class="op">)</span></code></pre></div>
<pre><code>##   SamplingEventIdentifier species_id ObservationCount        CommonName
## 1     RCBIOTABASE-10008-1     252456                1           Monarch
## 2     RCBIOTABASE-10008-1     252491                0       Red Admiral
## 3     RCBIOTABASE-10008-1     252494                0 Black Swallowtail
## 4     RCBIOTABASE-10015-1     252456                2           Monarch
## 5     RCBIOTABASE-10015-1     252491                0       Red Admiral
## 6     RCBIOTABASE-10015-1     252494                0 Black Swallowtail
##      ScientificName
## 1  Danaus plexippus
## 2  Vanessa atalanta
## 3 Papilio polyxenes
## 4  Danaus plexippus
## 5  Vanessa atalanta
## 6 Papilio polyxenes</code></pre>
<p>To keep other columns associated with the sampling event, specify them, in addition to the sampling event id, in the <code>by</code> argument. By default, <code>SamplingEventIdentifier</code> is used to identify specific sampling events.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rc_filled</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_zero_fill.html">format_zero_fill</a></span><span class="op">(</span><span class="va">rc_all_species</span>, 
                              by <span class="op">=</span> <span class="st">"SamplingEventIdentifier"</span>,
                              extra_event <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"latitude"</span>, <span class="st">"longitude"</span><span class="op">)</span>,
                              extra_species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"CommonName"</span>, <span class="st">"ScientificName"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>##  - Converted 'fill' column (ObservationCount) from character to numeric</code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">rc_filled</span><span class="op">)</span></code></pre></div>
<pre><code>##   SamplingEventIdentifier species_id ObservationCount        CommonName
## 1     RCBIOTABASE-10008-1     252456                1           Monarch
## 2     RCBIOTABASE-10008-1     252491                0       Red Admiral
## 3     RCBIOTABASE-10008-1     252494                0 Black Swallowtail
## 4     RCBIOTABASE-10015-1     252456                2           Monarch
## 5     RCBIOTABASE-10015-1     252491                0       Red Admiral
## 6     RCBIOTABASE-10015-1     252494                0 Black Swallowtail
##      ScientificName latitude longitude
## 1  Danaus plexippus  45.5111 -77.50533
## 2  Vanessa atalanta  45.5111 -77.50533
## 3 Papilio polyxenes  45.5111 -77.50533
## 4  Danaus plexippus  45.5111 -77.50533
## 5  Vanessa atalanta  45.5111 -77.50533
## 6 Papilio polyxenes  45.5111 -77.50533</code></pre>
</div>
<div id="zero-filling-by-other-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#zero-filling-by-other-variables" class="anchor"></a>Zero-filling <code>by</code> other variables</h2>
<p>Sampling events aren’t the only way of zero-filling data. Perhaps you’re only interested in whether a species has/has not been observed in a particular location.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rc_loc_filled</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_zero_fill.html">format_zero_fill</a></span><span class="op">(</span><span class="va">rc_all_species</span>, 
                                  by <span class="op">=</span> <span class="st">"utm_square"</span><span class="op">)</span></code></pre></div>
<pre><code>##  - Consider summarizing multiple observations per set of 'by' before zero-filling to increase speed</code></pre>
<pre><code>##  - Converted 'fill' column (ObservationCount) from character to numeric</code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">rc_loc_filled</span><span class="op">)</span></code></pre></div>
<pre><code>##   utm_square species_id ObservationCount
## 1    18TTR94     252456                1
## 2    18TTR94     252491                0
## 3    18TTR94     252494                0
## 4    18TUR04     252456                1
## 5    18TUR04     252456                1
## 6    18TUR04     252456                1</code></pre>
<p>The message about summarizing multiple observations means that we have multiple observations per <code>utm_square</code>. This example isn’t large enough to be slowed down much, but in larger examples, it can be much faster to simplify the dataset first.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rc_sum</span> <span class="op">&lt;-</span> <span class="va">rc_all_species</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">utm_square</span>, <span class="va">species_id</span>, <span class="va">AllSpeciesReported</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>ObservationCount <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">ObservationCount</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by 'utm_square', 'species_id'. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">rc_sum</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 4
## # Groups:   utm_square, species_id [6]
##   utm_square species_id AllSpeciesReported ObservationCount
##   &lt;chr&gt;           &lt;int&gt; &lt;chr&gt;                         &lt;dbl&gt;
## 1 18TTR94        252456 Yes                               1
## 2 18TUR04        252456 Yes                              67
## 3 18TUR04        252491 Yes                              46
## 4 18TUR04        252494 Yes                              22
## 5 18TUR17        252456 Yes                               1
## 6 18TUR27        252491 Yes                               1</code></pre>
<p>Now if we zero-fill this data set, we get a zero-filled, aggregated dataset.</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rc_sum_filled</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_zero_fill.html">format_zero_fill</a></span><span class="op">(</span><span class="va">rc_sum</span>, by <span class="op">=</span> <span class="st">"utm_square"</span><span class="op">)</span></code></pre></div>
<pre><code>## Adding missing grouping variables: `species_id`</code></pre>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">rc_sum_filled</span><span class="op">)</span></code></pre></div>
<pre><code>##   utm_square species_id ObservationCount
## 1    18TTR94     252456                1
## 2    18TTR94     252491                0
## 3    18TTR94     252494                0
## 4    18TUR04     252456               67
## 5    18TUR04     252491               46
## 6    18TUR04     252494               22</code></pre>
</div>
<div id="filling-specific-species" class="section level2">
<h2 class="hasAnchor">
<a href="#filling-specific-species" class="anchor"></a>Filling specific species</h2>
<p>Up to now in these examples we’ve been filling all the species present in the data, but often you might be only interested in one or two species. We can specify which species with the <code>species</code> argument.</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rc_sp_filled</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_zero_fill.html">format_zero_fill</a></span><span class="op">(</span><span class="va">rc_all_species</span>, species <span class="op">=</span> <span class="st">"252456"</span><span class="op">)</span></code></pre></div>
<pre><code>##  - Converted 'fill' column (ObservationCount) from character to numeric</code></pre>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">rc_sp_filled</span><span class="op">)</span></code></pre></div>
<pre><code>##   SamplingEventIdentifier species_id ObservationCount
## 1     RCBIOTABASE-10008-1     252456                1
## 2     RCBIOTABASE-10015-1     252456                2
## 3     RCBIOTABASE-10030-1     252456                0
## 4     RCBIOTABASE-10068-1     252456                0
## 5     RCBIOTABASE-10070-1     252456                2
## 6     RCBIOTABASE-10087-1     252456                0</code></pre>
</div>
<div id="filling-other-variables" class="section level2">
<h2 class="hasAnchor">
<a href="#filling-other-variables" class="anchor"></a>Filling other variables</h2>
<p>By default <code><a href="../reference/format_zero_fill.html">format_zero_fill()</a></code> adds 0’s to the <code>ObservationCount</code> column, but you can specify any column to zero fill.</p>
<p>For example, if you wanted to deal only with Presence/Absence you could create a new <code>presence</code> column and zero-fill this column.</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rc_presence</span> <span class="op">&lt;-</span> <span class="va">rc_all_species</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">species_id</span>, <span class="va">AllSpeciesReported</span>, <span class="va">ObservationCount</span>, <span class="va">SamplingEventIdentifier</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>presence <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html">if_else</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span><span class="op">(</span><span class="va">ObservationCount</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">rc_presence</span><span class="op">)</span></code></pre></div>
<pre><code>##   species_id AllSpeciesReported ObservationCount SamplingEventIdentifier
## 1     252456                Yes                6      RCBIOTABASE-5553-1
## 2     252491                Yes                1      RCBIOTABASE-5553-1
## 3     252456                Yes                2      RCBIOTABASE-5547-1
## 4     252456                Yes                1      RCBIOTABASE-5546-1
## 5     252494                Yes                1      RCBIOTABASE-6235-1
## 6     252491                Yes                3      RCBIOTABASE-5545-1
##   presence
## 1     TRUE
## 2     TRUE
## 3     TRUE
## 4     TRUE
## 5     TRUE
## 6     TRUE</code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rc_presence_filled</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_zero_fill.html">format_zero_fill</a></span><span class="op">(</span><span class="va">rc_presence</span>, fill <span class="op">=</span> <span class="st">"presence"</span><span class="op">)</span></code></pre></div>
<pre><code>##  - Converted 'fill' column (presence) from logical to numeric</code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">rc_presence_filled</span><span class="op">)</span></code></pre></div>
<pre><code>##   SamplingEventIdentifier species_id presence
## 1     RCBIOTABASE-10008-1     252456        1
## 2     RCBIOTABASE-10008-1     252491        0
## 3     RCBIOTABASE-10008-1     252494        0
## 4     RCBIOTABASE-10015-1     252456        1
## 5     RCBIOTABASE-10015-1     252491        0
## 6     RCBIOTABASE-10015-1     252494        0</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Steffi LaZerte, Denis LePage.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
